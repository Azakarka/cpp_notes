# **–£–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏**


> –º—ã —É–∂–µ –∑–Ω–∞–µ–º (–∑–Ω–∞–µ–º –≤–µ–¥—åüëÄüëÄüëÄ) –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—ã—á–Ω—ã–º–∏ —É–∫–∞–∑–∞—Ç–µ–ª—è–º–∏. 
> —Ç–∞–∫–∂–µ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –µ—Å–ª–∏ –º—ã –∑–∞—Ö–æ—Ç–∏–º –≤—ã–¥–µ–ª–∏—Ç—å –ø–∞–º—è—Ç—å, –µ–µ –Ω–∞–¥–æ –±—É–¥–µ—Ç —á–∏—Å—Ç–∏—Ç—å. 
> —á—Ç–æ–±—ã –≤—Å–µ–º —ç—Ç–∏–º –Ω–µ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –ø—Ä–∏–¥—É–º–∞–ª–∏ —É–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ (–∫–∞–∫ –∂–µ —ç—Ç–æ –ø–æ-—á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏) –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞–º —Å–æ—á–Ω–æ –æ—Ç–¥—ã—Ö–∞—Ç—å –Ω–∞ –¥–∏–≤–∞–Ω–µ –∏ –≤–æ–æ–±—â–µ –Ω–∏ –æ —á–µ–º –Ω–µ –¥—É–º–∞—Ç—å.

## **unique_ptr**

> –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é –≤–∞—à–µ–º—É –≤–Ω–∏–º–∞–Ω–∏—é —Å–∞–º–æ–≥–æ –ø–µ—Ä–≤–æ–≥–æ —á–µ–ª–∏–∫–∞, unique_pointer

```cpp
#include memory

std::unique_ptr<int> up(new int(123));
```

> –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:
> 
> –æ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫—É—Å–º–∞–Ω –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—ã–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–∂–µ—Ç –≤–ª–∞–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —É–∫–∞–∑–∞—Ç–µ–ª—å
> 
> –ø–æ–∏–Ω—Ç–µ—Ä –æ—Ç–¥—ã—Ö–∞–µ—Ç —Å–µ–±–µ –Ω–∞ —Å—Ç–µ–∫–µ, —Å—Ç—Ä–æ–∏—Ç –¥–æ–º, —Å–∞–∂–∞–µ—Ç –¥–µ—Ä–µ–≤–æ, –Ω–æ –∫–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∑–ª–æ–π –∫–æ–Ω–µ—Ü —Å–∫–æ—É–ø–∞, —Å—Ç–µ–∫ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–ø–∞—Ç—å—Å—è, —É–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç–ª–µ—Ç–∞–µ—Ç, –∞ –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º –∏ –æ—á–∏—â–∞–µ—Ç—Å—è –ø–∞–º—è—Ç—å, —á—Ç–æ –æ–Ω –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ç
> 
> –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –Ω–∏–∫–∞–∫ –Ω–µ–ª—å–∑—è (—Ç—É–ø–æ —É–¥–∞–ª–µ–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä –∞—á–µ –Ω–∞–º), –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º: –µ—Å—Ç—å –¥–≤–∞ —Ç–∞–∫–∏—Ö —á–µ–ª–∞, –æ–¥–∏–Ω —É–º–∏—Ä–∞–µ—Ç, –æ—á–∏—â–∞–µ—Ç—Å—è –æ—Ç –≥—Ä–µ—Ö–æ–≤ `c++`-—à–Ω—ã—Ö –∏ –ø–∞–º—è—Ç—å –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –≤–ª–∞–¥–µ–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –∞ –∫–æ–≥–¥–∞ —É–∂–µ –≤—Ç–æ—Ä–æ–π –∑–∞—Ö–æ—á–µ—Ç –æ—á–∏—Å—Ç–∏—Ç—å—Å—è, –º—ã —Å–ª–æ–≤–∏–º `Undefined Behaviour`, —Ç–∞–∫ –∫–∞–∫ –æ—á–∏—â–∞—Ç—å-—Ç–æ –Ω–µ—á–µ–≥–æ


### *–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å?*
```cpp
#include memory

std::unique_ptr<int> up(new int(123));
*up; // –ø–æ–ª—É—á–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —É–∫–∞–∑–∞—Ç–µ–ª—è
up.get(); // –¥–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø–∞–º—è—Ç—å

// –æ—Ñ—Ñ-—Ç–æ–ø –µ–≥–æ –º–æ–∂–Ω–æ –º—É–≤–Ω—É—Ç—å –∏ —Å–≤–∞–ø–Ω—É—Ç—å (–º—É–≤ –ø—Ä–æ–π–¥–µ–º –ø–æ—Ç–æ–º –¥–∞)

up2 = std::move(up);
// up2 - —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–µ–≥–µ—Ç–∏–º–Ω—ã–º –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –ø–∞–º—è—Ç–∏, up - –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∏ —Å —á–µ–º, –µ–¥–µ—Ç –¥–æ–º–æ–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ –æ–±—ã—á–Ω–æ nullptr)
```


## **shared_ptr**

> –∞ –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –æ–¥–∏–Ω –∫—É—Å–º–∞–Ω –ø–∞–º—è—Ç–∏?

> –≤ –¥–µ–ª–æ –≤—Å—Ç—É–ø–∞–µ—Ç –¥—Ä—É–∂–±–∞ —ç—Ç–æ –º–∞–≥–∏—è
```cpp
std::shared_ptr sp(new int(123));
std::shared_ptr sp2;

// shared —É–∫–∞–∑–∞—Ç–µ–ª–∏ –º–æ–∂–Ω–æ —É–∂–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
sp2 = sp;

// –≤—Ç–æ—Ä–æ–π —á–µ–ª —Ç–æ—á–Ω–æ —Ç–∞–∫–∂–µ –ø–æ–ª–Ω–æ–ø—Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç –≤–ª–∞–¥–µ—Ç—å –ø–∞–º—è—Ç—å—é
```


### *–∫–∞–∫ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç*
![](../–ø–∏–∫—á–∏/shared_ptr.png)

> –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–º –æ–±—ä–µ–∫—Ç –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ –Ω–µ–≥–æ —É–∫–∞–∑—ã–≤–∞—é—Ç.

> –∫–æ–≥–¥–∞ –º—ã —É–¥–∞–ª—è–µ–º –∫–∞–∫–æ–π-—Ç–æ —É–º–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å, —ç—Ç–æ –æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–º–µ–Ω—å—à–∞–µ—Ç —Å–≤–æ–π —Å—á–µ—Ç—á–∏–∫ –Ω–∞ –µ–¥–∏–Ω–∏—á–∫—É, –∞ –µ—Å–ª–∏ –Ω–∞ –Ω–µ–≥–æ –Ω–∏–∫—Ç–æ —É–∂–µ –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç —É–º–∏—Ä–∞–µ—Ç –æ—Ç –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–∞ (—Ç–∞–∫–æ–≤–∞ –∂–∏–∑–Ω—å :( )

### *–ú–∏–Ω–∏-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª*
```cpp
sp.use_count();
// –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ —Å—Å—ã–ª–æ–∫ —É–∫–∞–∑—ã–≤–∞—é—Ç
```

> —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω `shared_ptr` —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç "–≤–Ω–µ—à–Ω–µ–≥–æ" —É–∫–∞–∑–∞—Ç–µ–ª—è, –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç –¥—Ä—É–≥–∏—Ö `shared_ptr` (–≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∫—É—Å–∫–∞ –ø–∞–º—è—Ç–∏ –∫–æ–Ω–µ—á–Ω–æ)




## **weak_ptr**

> –ù–µ–º–Ω–æ–≥–æ –ø–æ–¥—É–º–∞–µ–º –∫–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –µ—Å—Ç—å —É `shared_ptr`.

> –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º —Å–µ–±–µ –¥–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫.

![](../–ø–∏–∫—á–∏/weak_ptr.png)

> —É –Ω–∞—Å –∫–∞–∂–¥—ã–π —á–µ–ª–∏–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ, –∞ –µ—â–µ –º—ã –æ—Ç–¥–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–º –≤–æ–æ–±—â–µ.

> —Ç–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –¥–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫, –ø–æ–ª—É—á–∏–º:
![](../–ø–∏–∫—á–∏/weak_ptr2.png)

> –≤–∏–¥–Ω–æ, —á—Ç–æ –Ω–∏—Ñ–∏–≥–∞ —É –Ω–∞—Å –Ω–µ —É–¥–∞–ª–∏—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ –∫–∞–∂–¥—É—é –Ω–æ–¥—É –≤—Å–µ –µ—â–µ –∫—Ç–æ-—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç. –∏–º–µ–Ω–Ω–æ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ç–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –∏ –ø—Ä–∏–¥—É–º–∞–ª–∏ `weak_ptr`

## weak_ptr

```cpp
weak_ptr<int> wp = sp;
// –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç shared_pointer, –æ–Ω –Ω–µ –≤–ª–∞–¥–µ–µ—Ç —ç—Ç–æ–π –ø–∞–º—è—Ç—å—é

// —Ç–æ –µ—Å—Ç—å —ç—Ç–æ—Ç —á–µ–ª–∏–∫ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —É–∫–∞–∑–∞—Ç–µ–ª—å –≤ —Å—á–µ—Ç—á–∏–∫–µ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π
```

> –ø–æ—ç—Ç–æ–º—É —Å–¥–µ–ª–∞–µ–º –≤—Å–µ –æ–±—Ä–∞—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ `weak_ptr` –∏ —É–∂–µ –≤—Å–µ —Å–ø–æ–∫–æ–π–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—Å—è
![](../–ø–∏–∫—á–∏/weak_ptr3.png)


```c++
wp.lock() // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç shared_pointer
// 1) –µ—Å–ª–∏ –ø–∞–º—è—Ç—å –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∞ -> nullptr
// 2) –∏–Ω–∞—á–µ –ø–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–ª—É—á–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—é, —á—Ç–æ –Ω–∏–∫—Ç–æ —ç—Ç—É –ø–∞–º—è—Ç—å –Ω–µ —É–¥–∞–ª–∏—Ç
```

> –µ—Å—Ç—å —Ç–∞–∫–∂–µ –≤–µ—Ä—Å–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Å–∏–≤–æ–º

> –î–ó: –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ —É–º–µ—é—Ç —É–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏




# **–ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ**

> –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤


> –ø—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –∫–ª–∞—Å—Å–∞
```cpp
class Student {  
public:  
    Student(const std::string &name, int group) : name_(name), group_(group) {}  
  
  
    std::string GetInfo() const {  
        return "name: " + name_ + ", group: " + std::to_string(group_);  
    }  
private:  
    std::string name_;  
    int group_;  
};  
  
class Teacher {  
public:  
    Teacher(const std::string &name, const std::string &course) : name_(name), course_(course) {}  
  
  
    std::string GetInfo() const{  
        return "name: " + name_ + ", course: " + course_;  
    }  
private:  
    std::string name_;  
    std::string course_;  
};
```

> —Ç–µ–ø–µ—Ä—å –º—ã —Ö–æ—Ç–∏–º, –∫ –ø—Ä–∏–º–µ—Ä—É, –≤—ã–≤–µ—Å—Ç–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—É–¥–µ–Ω—Ç–∞
```cpp
void Print(const Student& student) {  
    std::cout << student.GetInfo() << std::endl;  
}
```

> –∏ –Ω–∞–º –≤—ã–≤–µ–¥–µ—Ç—Å—è, —Ñ–æ–∫—É—Å–æ–≤ —Ç—É—Ç –Ω–µ—Ç, –Ω–æ —á—Ç–æ –µ—Å–ª–∏ –º—ã –∑–∞—Ö–æ—Ç–∏–º –≤—ã–≤–µ—Å—Ç–∏ –∏ —É—á–∏—Ç–µ–ª—è?
```cpp 
void Print(const Student& student) {  
    std::cout << student.GetInfo() << std::endl;  
}  
void Print(const Teacher& teacher) {  
    std::cout << teacher.GetInfo() << std::endl;  
}

// –Ω–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä–∞—Ç—å –≤ "–Ω–∞–π–¥–∏—Ç–µ 10 –æ—Ç–ª–∏—á–∏–π"

// —Ñ—É–Ω–∫—Ü–∏–∏ –∞–±—Å–æ–ª—é—Ç–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –Ω—É –∏ –Ω–∞—Ñ–∏–≥ –Ω–∞–º –Ω—É–∂–µ–Ω —Ç–∞–∫–æ–π –∫–æ–ø–∏–ø–∞—Å—Ç?
```

> –∑–¥–µ—Å—å –≤–∞–∂–Ω–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —É—á–∏—Ç–µ–ª—è —Ç–æ–∂–µ –ª—é–¥–∏, –ø–æ—ç—Ç–æ–º—É –ø—Ä–µ–¥–ª–∞–≥–∞—é —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å —á–µ–ª–æ–≤–µ–∫
```cpp
class Person {  
public:  
    std::string GetInfo() const {  
        return name_;  
    }  
private:  
    std::string name_;  
};

// —É—Å—Ç—Ä–æ–∏–º –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å–ª–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ –Ω–∞–ø–∏—à–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–∫–∞

class Student : public Person {
	...
}

// —Ç–æ–∂–µ —Å–∞–º–æ–µ –∏ –¥–ª—è teacher
class Teacher : public Person{
	...
}

// –µ—Å–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç—É—Ç private, —Ç–æ –º—ã –ø—Ä–æ—Å—Ç–æ –Ω–µ —Å–º–æ–∂–µ–º –Ω–µ—è–≤–Ω–æ (–∏ —è–≤–Ω–æ) –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –∫–ª–∞—Å—Å—É –ø—Ä–µ–¥–∫–∞
```

> —á—Ç–æ –º—ã —Å–¥–µ–ª–∞–ª–∏?
![](../–ø–∏–∫—á–∏/inheritance.png)

> –∫–æ–≥–¥–∞ –∫–ª–∞—Å—Å `Student` –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `Person`, –æ–Ω –∫–∞–∫ –±—ã –≤ —Å–≤–æ–µ –Ω–∞—á–∞–ª–∞ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ –µ–≥–æ –º–µ—Ç–æ–¥—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –ø—Ä–æ—á–µ–µ. –¢–æ –µ—Å—Ç—å `Student` —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ `Person`. 

> —Å–∞–º–æ–π –≤–∞–∂–Ω–æ–π –¥–µ—Ç–∞–ª—å—é —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ —Å—Å—ã–ª–∫–∏ –∏ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ—Ç–æ–º–∫–æ–≤ –Ω–µ—è–≤–Ω–æ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ —Å—Å—ã–ª–∫–∞–º –∏ —É–∫–∞–∑–∞—Ç–µ–ª—è–º –ø—Ä–µ–¥–∫–æ–≤, –ø–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–∞–∫–æ–π –∫–æ–¥
```cpp

void Print(const Person& person) {
	std::cout << person.GetInfo() << std::endl;
}

int main() {
	Student student = Student("Azik_v_tazik", 2007);
	Print(student);
}

// —ç—Ç–æ—Ç –∫–æ–¥ –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–µ–¥–µ—Ç
// Azik_v_tazik, —Ç–∞–∫ –∫–∞–∫ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ Print –≤—ã–∑–æ–≤–µ—Ç—Å—è Person::GetInfo

// –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤–µ–¥—å –º—ã –ø–æ —Ñ–∞–∫—Ç—É –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª–∏ GetInfo() –æ—Ç Person, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—ã–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–º—è. 

// –∫–∞–∫-—Ç–æ –ø–æ–∫–∞ –Ω–µ —Ç–æ, —á—Ç–æ –±—ã –º—ã —Ö–æ—Ç–µ–ª–∏, –¥–ª—è —ç—Ç–æ –≤ –ø–∞—Ä—Ç–∏—é –≤—Å—Ç—É–ø–∞–µ—Ç virtual
```

```cpp
// –Ω–∞–ø–∏—à–µ–º
class Person {  
public:  
	...
    virtual std::string GetInfo() const {  
        return name_;  
    }  
    ...
};

// —á—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç virtual?
```

## **Virtual**

> –∫–æ–≥–¥–∞ –≤ –ø—Ä–µ–¥–∫–µ –º—ã –¥–µ–ª–∞–µ–º –∫–∞–∫—É—é-—Ç–æ —Ñ—É–Ω–∫—Ü–∏—é `virtual`, —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø–æ—Ç–æ–º–∫–∞—Ö —Å —Ç–∞–∫–æ–π –∂–µ —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π —Ç–æ–∂–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è `virtual`, —á—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç?

> —Å –ø–æ–º–æ—â—å—é –¥–∞–Ω–Ω–æ–π –ø—Ä–∏–∫–æ–ª—é—Ö–∏ –º—ã –º–æ–∂–µ–º –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –±—ã –∏–∑ –ø–æ—Ç–æ–º–∫–æ–≤, –Ω–æ –ø–æ —Ñ–∞–∫—Ç—É –∏–∑ —Å–µ–±—è –∂–µ. –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∫–æ–¥
```cpp

class Person {  
	...
    virtual std::string GetInfo() const {  
        return name_;  
    } 
    ...
};  
  
class Student : public Person {  
	...
    std::string GetInfo() const {  
        return "name: " + name_ + ", group: " + std::to_string(group_);  
    }  
	...
};

  
void Print(const Person &person) {  
    std::cout << person.GetInfo() << std::endl;  
}  
  
int main() {  
    Student student = Student("Ivan", 123);  
    Print(student);
}

// —á—Ç–æ —Ç—É—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è? –∏–º–µ–Ω–Ω–æ —á—Ç–æ Student::GetInfo

// –∏–º–µ–Ω–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –∏ –Ω—É–∂–µ–Ω virtual
```

> –∫–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è?
> —É –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –µ—Å—Ç—å —Ç–∞–∫–∞—è —à—Ç—É–∫–∞ –∫–∞–∫ `__vfptr` - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –µ–≥–æ —Ç–∞–±–ª–∏—Ü—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

> —Ç–∞–±–ª–∏—Ü–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —ç—Ç–æ –≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è —Ç–∞–∫–æ–π `map<name_, goto>`, —Ç–æ –µ—Å—Ç—å –ø–æ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –Ω–∞–¥–æ –∑–∞–ø—É—Å–∫–∞—Ç—å

> –∫–æ–≥–¥–∞ –º—ã –Ω–µ—è–≤–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º `student` –∫ person, –Ω–∞—à `__vfptr` –æ—Å—Ç–∞–µ—Ç—Å—è, —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ —É –Ω–∞—Å –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –æ—Ç –∫–ª–∞—Å—Å–∞ `Student`, –∞ –Ω–µ `Person`

> –∞ –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ –∫–∞–∫ —Ä–∞–∑ –∏ –ª–µ–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏—è `Student::GetInfo()`, –∞ –Ω–µ `Person::GetInfo()`

> –µ—Å–ª–∏ –±—ã –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏ `Person`, —Ç–æ –∫–æ–Ω–µ—á–Ω–æ –∂–µ –∏ —Ç–∞–±–ª–∏—Ü–∞ –±—ã–ª–∞ –±—ã —Å–æ–æ—Ç–≤–µ—Å—Ç–≤—É—é—â–∞—è

> –ß–µ–º –ø–ª–æ—Ö–∏ virtual –≤—ã–∑–æ–≤—ã?
> 1) —Å–∞–º –ø–æ–∏—Å–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ –∏ –ø—Ä–æ—á–µ–µ –Ω–µ –æ—á–µ–Ω—å —Ç–æ –∏ –±—ã—Å—Ç—Ä—ã–π
> 2) —Ç–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–ª—å–∑—è –∑–∞–∏–Ω–ª–∞–π–Ω–∏—Ç—å (`inline Foo`), —Ç–æ –µ—Å—Ç—å —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –ø—Ä–æ—á–µ–º, –∏ –∑–∞–∏–Ω–ª–∞–π–Ω–∏—Ç—å –º—ã –Ω–µ –º–æ–∂–µ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –Ω–µ –º–æ–∂–µ–º –∑–Ω–∞—Ç—å —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞

```cpp
// —Ç–∞–±–ª–∏—Ü–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è —Å—Å—ã–ª–æ–∫ –∏ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π

void Print(Student student) {
	return student.GetInfo();
}
// –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–Ω –ø—Ä–æ—Å—Ç–æ –≤–æ–∑—å–º–µ—Ç –º–µ—Ç–æ–¥ –≤ —Å–≤–æ–µ–º –∫–ª–∞—Å—Å–µ, –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –ø–æ–∏—Å–∫–æ–≤
```

> —Å—Ç–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å, —á—Ç–æ `virtual` –æ–±—ã—á–Ω–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –ø–µ—Ä–µ–ø–∏—Å–∫—É —Ñ—É–Ω–∫—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ –ø–æ—Ç–æ–º–∫–æ–≤, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞, —Ç–æ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –æ—Ç –ø—Ä–µ–¥–∫–æ–≤—Å–∫–æ–π.

> –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–µ –∑–∞–±—ã—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å —Ç–æ–π –∂–µ —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è override 
> 
> `void Foo() override {}`
> 
> –æ–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É, —á—Ç–æ –≥–¥–µ-—Ç–æ –≤ –ø—Ä–µ–¥–∫–∞—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ö–æ—Ç–∏–º –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å, —Ç–∞–∫ —á—Ç–æ –µ—Å–ª–∏ —Ç–∞–∫–æ–π –Ω–µ—Ç —Ç—ã –ø–æ–∂–∞–ª—É–π—Å—è


### **–≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ –ø—Ä–µ–¥–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞**
```cpp
// –æ–ª–¥—ã —Ç—É—Ç?

// –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ Student –±—ã–ª–∞ —Ç–∞–∫–æ–π
std::string GetInfo() const override {  
    return "name: " + name_ + ", group: " + std::to_string(group_);  
}
// –Ω–æ —Ç–∞–∫ –∫–∞–∫ –∏–º—è —É–∂–µ –µ—Å—Ç—å –∏ –≤ Person –±—ã–ª–æ –±—ã –Ω–µ–ø–ª–æ—Ö–æ –≤—ã–∑—ã–≤–∞—Ç—å –µ–≥–æ
std::string GetInfo() const override {  
    return GetInfo() + ", group: " + std::to_string(group_);  
}
// –¥–∞, —ç—Ç–æ —Ä–µ–∫—É—Ä—Å–∏—è. –ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –Ω–∞–π–¥–µ—Ç –æ–ø—è—Ç—å —Ç–∞–∫–∏ Student::GetInfo() –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏–º–µ–Ω–Ω–æ –æ–Ω –∏ –ª–µ–∂–∏—Ç
// —á—Ç–æ–±—ã –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥–∫–æ–≤—ã–π, –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å
std::string GetInfo() const override {  
    return Person::GetInfo() + ", group: " + std::to_string(group_);  
}
```



## **–¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä**
```cpp
// –Ω—É —Å–Ω–∞—á–∞–ª–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

// —Ç—É—Ç –≤—Å–µ –ø—Ä–æ—Å—Ç–æ —Å–Ω–∞—á–∞–ª–∞ –æ—Ç –ø—Ä–µ–¥–∫–∞ –ø–æ—Ç–æ–º –∫ –ø–æ—Ç–æ–º–∫—É, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –ø–æ—Ç–æ–º–∫–∞ –≤—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–µ–¥–∫–∞.

// –∞ –≤–æ—Ç —Å –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–µ –≤—Å–µ —Ç–∞–∫ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ. –í–æ–æ–±—â–µ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å virtual
Person* person = new Student("Ivan", 2010);
delete person

// —Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç Undefined Behaviour

// —Ç–∞–∫ –∫–∞–∫ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π, —Ç–æ –æ–Ω –ø–æ–∑–æ–≤–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ –æ—Ç Person, –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á—Ç–æ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –æ—Ç Student –Ω–µ –ø–æ–∑–æ–≤–µ—Ç—Å—è

// –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–ª–æ—Ö–∏–º –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è–º, —Ç–∞–∫ —á—Ç–æ –≤—Å–µ–≥–¥–∞ –ø–∏—à–µ–º

virtual ~Person {
	
}
```


# **–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å**

> –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞ —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å—Ç—ã–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º, —Ç–æ –∫–ª–∞—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–º
```cpp
// —á–∏—Å—Ç—ã–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫
virtual void foo() = 0;
// —Ç–æ –µ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –Ω–µ –∏–º–µ—é—â–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

// –º—ã –Ω–µ –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ (–ª–æ–≥–∏—á–Ω–æ –≤–µ–¥—å —á–∞—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞)

// –º–µ—Ç–æ–¥—ã –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏—Ö –Ω–∞—Å–ª–µ–¥–æ–≤–∞–ª–∏ –∏ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–ª–∏
```

> –Ω—É –∫ –ø—Ä–∏–º–µ—Ä—É —Ç–∞–∫–æ–π –∫–ª–∞—Å—Å
```cpp

class Printable{
	public:
	virtual void Print() const = 0; // —á–∏—Å—Ç—ã–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
}


// —ç—Ç–∞ —à—Ç—É–∫–∞ –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –≤ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ—Ç–æ–¥ –ø—Ä–∏–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∫–∞–∫ —Ä–∞–∑ –∏ –ø–µ—Ä–µ–ø–∏—à–µ–º

class Person : public Printable {
	void Print() const { // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
		...
	}
	...
}


void Print(const Printable& printable) {
	printable.Print();
}
```

> –µ—â–µ –ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å [—Ç—É—Ç](https://metanit.com/cpp/tutorial/5.12.php)


> –∫–ª–∞—Å—Å –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—Å–µ –º–µ—Ç–æ–¥—ã —á–∏—Å—Ç—ã–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å


> —á–∏—Å—Ç–æ –æ—Ñ—Ñ-—Ç–æ–ø
> –Ω–µ –≤—ã–∑—ã–≤–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —à—Ç—É–∫–∏ –∏–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ –∏ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫ –º–æ–º–µ–Ω—Ç—ã –≤—ã–∑–æ–≤–∞ –º–æ–≥–ª–∞ –µ—â–µ –Ω–µ –ø–æ—è–≤–∏—Ç—å—Å—è –∏–ª–∏ —É–∂–µ —É–¥–∞–ª–∏—Ç—å—Å—è